---

- hosts: all
  become: true
  tasks:

  - name: install base apps
    apt:
      name:
        - curl
        - tmux
        - cmatrix
        - htop
        - neofetch
        - ca-certificates
        - gnupg
        - lsb-release
        - zsh
        - zplug
        - wget
      state: latest

  - name: Make folders for Git projects
    ansible.builtin.file:
      path: "{{ item }}"
      state: directory
      owner: zyzyx
      group: zyzyx
      mode: '0770'
    loop:
      - /home/zyzyx/Git
      - /home/zyzyx/Git/ohmyzsh # delete after install
      - /usr/local/bin/oh-my-posh # owned by root
      - /home/zyzyx/.poshthemes # owned by me

  - name: Download oh-my-zsh installer
    get_url:
      url: https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh
      dest: /home/zyzyx/Git/ohmyzsh/install.sh

  - name: Change owner of files and folders
    ansible.builtin.file:
      path: "{{ item }}"
      state: directory
      recurse: yes
      owner: zyzyx
      group: zyzyx
    loop:
      - /home/zyzyx/Git
      - /home/zyzyx/.poshthemes

  - name: Add execute permsions to scripts
    file:
      path: "{{ item }}"
      state: file
      mode: u+rwx,g+rwx,o-rwx
    loop:
      - /home/zyzyx/Git/ohmyzsh/install.sh

  - name: Run oh-my-zsh installer
    command: sh /home/zyzyx/Git/ohmyzsh/install.sh --unattended